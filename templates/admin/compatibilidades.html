{% extends "admin/base_admin.html" %}
{% block subtitle %}Vincular Baterias e Carros{% endblock %}

{% block content %}
<div class="bg-white p-6 rounded-2xl shadow-sm border border-slate-200 mb-8">
    <h4 class="font-bold mb-4 text-slate-700">Criar Novo Vínculo</h4>
    <form method="POST" class="flex flex-col md:flex-row gap-4 items-end">
        <div class="flex-1">
            <label class="block text-sm font-medium text-slate-700 mb-1">Selecione a Bateria</label>
            <select name="battery_id" class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500" required>
                {% for b in batteries %}
                <option value="{{ b.id }}">{{ b.brand }} {{ b.amps }}Ah (R$ {{ b.price }})</option>
                {% endfor %}
            </select>
        </div>
        
        <div class="text-2xl text-slate-300 pb-1 hidden md:block">→</div>

        <div class="flex-1">
            <label class="block text-sm font-medium text-slate-700 mb-1">Selecione o Carro</label>
            <select name="car_id" class="w-full p-2 border rounded-lg focus:ring-2 focus:ring-blue-500" required>
                {% for c in cars %}
                <option value="{{ c.id }}">{{ c.make }} {{ c.model }} ({{ c.year_start }}-{{ c.year_end }})</option>
                {% endfor %}
            </select>
        </div>

        <button type="submit" class="bg-blue-600 text-white px-8 py-2 rounded-lg font-bold hover:bg-blue-700 transition">
            Vincular
        </button>
    </form>
</div>

<div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
    <table class="w-full text-left">
        <thead class="bg-slate-50 text-slate-500 text-xs uppercase">
            <tr>
                <th class="p-4">Bateria</th>
                <th class="p-4">Compatível com</th>
                <th class="p-4 text-right">Ação</th>
            </tr>
        </thead>
        <tbody class="divide-y divide-slate-100">
            {% for b in batteries %}
                {% for car in b.compatible_cars %}
                <tr>
                    <td class="p-4 font-bold text-blue-600">{{ b.brand }} {{ b.amps }}Ah</td>
                    <td class="p-4">{{ car.make }} {{ car.model }} ({{ car.year_start }})</td>
                    <td class="p-4 text-right">
                        <a href="{{ url_for('admin.remove_compatibility', b_id=b.id, c_id=car.id) }}" 
                           class="text-red-500 hover:text-red-700 text-sm font-medium">
                           Remover Vínculo
                        </a>
                    </td>
                </tr>
                {% endfor %}
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}